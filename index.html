<!DOCTYPE html>
<html lang="en" dir="ltr" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digital Card - Eng. Micheal Hamdy</title>
    
    <!-- CORRIGÉ: Liens mis à jour pour le nouveau logo -->
    <link rel="icon" type="image/png" href="rattanpalacelogo.png">
    <link rel="apple-touch-icon" href="rattanpalacelogo.png">

    <!-- Tailwind CSS & Font Awesome -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            /* Couleurs Mode Clair (Bloom Lavande) */
            --bg-page: #f3e8ff; /* Très léger lavande */
            --bg-card: rgba(255, 255, 255, 0.7);
            --text-primary: #1f2937; 
            --text-secondary: #4b5563; 
            --text-links: #4c1d95; /* Violet foncé */
            --bg-links: rgba(233, 213, 255, 0.6); /* Lavande transparent */
            --accent-color: #8b5cf6; /* Violet vibrante */
        }
        html.dark {
            /* Couleurs Mode Sombre (Fond Profond + Lavande) */
            --bg-page: #0f0518; /* Violet très sombre presque noir */
            --bg-card: rgba(30, 27, 75, 0.6); /* Indigo profond */
            --text-primary: #f9fafb; 
            --text-secondary: #e9d5ff; /* Lavande clair */
            --text-links: #e5e7eb; 
            --bg-links: rgba(76, 29, 149, 0.4); /* Violet sombre transparent */
            --particle-color: 'rgba(212, 175, 55, 0.5)'; /* OR (Gold) conservé pour les particules */
            --accent-color: #a78bfa; /* Lavande lumineux */
        }
        body { font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; background-color: var(--bg-page); transition: background-color 0.5s ease; }
        html[dir="rtl"] body { font-family: 'Cairo', sans-serif; }
        
        .lang-btn.active { background-color: var(--accent-color); color: white; font-weight: bold; }
        
        #card-background-canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; }
        .page { display: none; transition: opacity 0.3s ease-in-out; }
        .page.active { display: block; animation: fadeIn 0.3s ease-out; }
        
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes float { 0% { transform: translateY(0px); } 50% { transform: translateY(-5px); } 100% { transform: translateY(0px); } }
        .hover-float:hover { animation: float 2s ease-in-out infinite; }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">

    <!-- Conteneur principal -->
    <div class="relative w-full max-w-md rounded-3xl shadow-2xl p-6 sm:p-8 overflow-hidden transition-colors duration-500 border border-white/10" id="card-container" style="background-color: var(--bg-card); backdrop-filter: blur(12px);">
        
        <canvas id="card-background-canvas"></canvas>

        <!-- Conteneur pour le contenu dynamique -->
        <main id="app-content" class="relative z-10"></main>

    </div>

    <script>
        // --- 1. ÉTAT CENTRAL DE L'APPLICATION (Attaché à window pour la robustesse) ---
        window.appData = {
            state: { currentPage: 'main', currentLang: 'en', isDarkTheme: true },
            
            data: {
                translations: {
                    en: { 
                        name: "Eng. Micheal Hamdy", 
                        jobTitle: "CEO", 
                        companyName: "RATTAN PALACE",
                        addContact: "Add to contacts", 
                        companyProfile: "Company Profile", 
                        lastProjects: "Last Projects", 
                        callMe: "Call me", 
                        emailLabel: "Email Michael",
                        infoLabel: "Company Info",
                        locationLabel: "Location",
                        reviewLabel: "Rate us on Google",
                        whatsapp: "WhatsApp", 
                        instagram: "Instagram", 
                        cardTitle: "Digital Card - Eng. Micheal Hamdy", 
                        vCardFileName: "Eng_Micheal_Hamdy.vcf", 
                        projectsTitle: "My Projects", 
                        backButton: "Back" 
                    },
                    ar: { 
                        name: "المهندس مايكل حمدي", 
                        jobTitle: "المدير التنفيذي", 
                        companyName: "قصر الخيزران",
                        addContact: "أضف إلى جهات الاتصال", 
                        companyProfile: "ملف الشركة", 
                        lastProjects: "آخر المشاريع", 
                        callMe: "اتصل بي", 
                        emailLabel: "راسل مايكل",
                        infoLabel: "بريد الشركة",
                        locationLabel: "الموقع",
                        reviewLabel: "قيمنا على جوجل",
                        whatsapp: "واتساب", 
                        instagram: "انستغرام", 
                        cardTitle: "بطاقة رقمية - م. مايكل حمدي", 
                        vCardFileName: "م_مايكل_حمدي.vcf", 
                        projectsTitle: "مشاريعي", 
                        backButton: "رجوع" 
                    }
                },
                projects: [
                    { name: { en: "Al Nakhla Compound - 500 kitchens", ar: "مشروع مدينة النخلة كمبوند عدد ٥٠٠ مطبخ" }, description: { en: "Large-scale deployment of 500 high-quality kitchens.", ar: "تنفيذ وتوريد ٥٠٠ مطبخ عالي الجودة." }},
                    { name: { en: "Al Nakhla Compound - 10 Royal Villas", ar: "مشروع مدينة النخلة كمبوند عدد ١٠ فلل ملكية" }, description: { en: "Exclusive interior fit-out for 10 V.I.P. Royal Villas.", ar: "تنفيذ أعمال التصميم الداخلي الحصرية لعشر فلل ملكية." }},
                    { name: { en: "Al Nakhla Compound - 30 executive villas", ar: "مشروع مدينة النخلة كمبوند عدد ٣٠ فيلل تنفيذية" }, description: { en: "Delivered 30 executive villas with premium interior solutions.", ar: "تسليم ٣٠ فيلا تنفيذية مع حلول داخلية متميزة." }},
                    { name: { en: "Hilton Hotel King Saud University", ar: "مشروع فندق الهيلتون جامعه الملك سعود" }, description: { en: "Marble columns and quartz counters execution.", ar: "تنفيذ أعمدة رخامية وتجاليد كوارتز." }},
                ]
            }
        };

        // --- 2. FONCTIONS GLOBALES (Accessibles via window) ---
        
        window.setLang = function(lang) { 
            window.appData.state.currentLang = lang; 
            renderApp(); 
        };

        window.setTheme = function() { 
            const newState = !window.appData.state.isDarkTheme;
            window.appData.state.isDarkTheme = newState;
            document.documentElement.classList.toggle('dark', newState);
            
            renderApp();
            
            // Relancer l'animation pour changer la couleur des particules
            if(window.animationFrameId) cancelAnimationFrame(window.animationFrameId);
            initParticles();
            animateParticles();
        };

        window.showPage = function(page) { 
            window.appData.state.currentPage = page; 
            renderApp(); 
        };

        window.downloadVCard = function() {
            const state = window.appData.state;
            const T = window.appData.data.translations[state.currentLang];
            const contact = { 
                firstName: 'Micheal', 
                lastName: 'Hamdy', 
                title: T.jobTitle, 
                company: T.companyName,
                phone: '+966556988973', 
                email: 'michael@rattanpalace.com', 
                emailInfo: 'info@rattanpalace.com',
                instagramUrl: 'https://www.instagram.com/rattanpalace.sa/',
                website: 'https://rattanpalace.com'
            };
            const vCard = `BEGIN:VCARD\nVERSION:3.0\nN:${contact.lastName};${contact.firstName};;;\nFN:${contact.firstName} ${contact.lastName}\nTITLE:${contact.title}\nORG:${contact.company}\nTEL;TYPE=CELL:${contact.phone}\nEMAIL;type=INTERNET;type=WORK:${contact.email}\nEMAIL;type=INTERNET;type=HOME:${contact.emailInfo}\nURL:${contact.instagramUrl}\nEND:VCARD`;
            
            try {
                const blob = new Blob([vCard], { type: 'text/vcard;charset=utf-8' });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = T.vCardFileName || 'contact.vcf';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            } catch (e) {
                console.error("VCard download failed", e);
            }
        };

        // --- 3. MOTEUR DE RENDU ---
        function renderApp() {
            const content = document.getElementById('app-content');
            const state = window.appData.state;
            const lang = state.currentLang;
            const T = window.appData.data.translations[lang];
            
            // Mise à jour de la direction du texte
            document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
            document.title = T.cardTitle;

            // HTML Commun : En-tête (Langue + Thème)
            const headerHTML = `
                <div class="flex justify-between items-center mb-6">
                    <div class="flex border border-gray-300 dark:border-gray-500 rounded-lg p-1 bg-white/40 dark:bg-gray-800/40 backdrop-blur-md">
                        <button onclick="window.setLang('en')" class="lang-btn px-3 py-1 rounded-md text-sm transition-all duration-300 ${lang === 'en' ? 'active' : 'text-gray-600 dark:text-gray-300 hover:bg-white/50 dark:hover:bg-gray-700'}">English</button>
                        <button onclick="window.setLang('ar')" class="lang-btn px-3 py-1 rounded-md text-sm transition-all duration-300 ${lang === 'ar' ? 'active' : 'text-gray-600 dark:text-gray-300 hover:bg-white/50 dark:hover:bg-gray-700'}">العربية</button>
                    </div>
                    <button onclick="window.setTheme()" class="p-2 rounded-lg bg-white/40 dark:bg-gray-800/40 text-yellow-500 dark:text-yellow-400 border border-gray-300 dark:border-gray-500 hover:scale-110 transition-transform">
                        ${state.isDarkTheme ? '<i class="fas fa-moon"></i>' : '<i class="fas fa-sun"></i>'}
                    </button>
                </div>
            `;

            const backButtonHTML = `
                <div class="flex items-center justify-between mb-6">
                    <button onclick="window.showPage('main')" class="px-4 py-2 rounded-lg bg-white/40 dark:bg-gray-800/40 text-gray-700 dark:text-gray-200 border border-gray-300 dark:border-gray-500 hover:bg-white/60 transition-all">
                        <i class="fas fa-arrow-${lang === 'ar' ? 'right' : 'left'}"></i> ${T.backButton}
                    </button>
                </div>
            `;

            let pageHTML = '';

            if (state.currentPage === 'main') {
                pageHTML = `
                    ${headerHTML}
                    
                    <!-- Profil -->
                    <div class="flex flex-col items-center text-center mb-8">
                        <div class="relative">
                            <img class="w-32 h-32 rounded-full mb-4 ring-4 ring-purple-500 ring-offset-2 ring-offset-transparent object-cover shadow-lg" src="joseph carte photo.png" alt="Micheal Hamdy">
                            <div class="absolute bottom-4 right-0 w-6 h-6 bg-green-500 border-2 border-white dark:border-gray-800 rounded-full"></div>
                        </div>
                        <h1 class="text-3xl font-bold mt-2" style="color: var(--text-primary);">${T.name}</h1>
                        <p class="text-lg font-medium opacity-90" style="color: var(--text-secondary);">${T.jobTitle}</p>
                        <p class="text-sm font-bold mt-1 tracking-wide uppercase text-purple-600 dark:text-purple-400">${T.companyName}</p>
                    </div>
                    
                    <!-- Actions Principales -->
                    <div class="grid grid-cols-2 gap-4 mb-6">
                        <button onclick="window.downloadVCard()" class="py-3 px-4 rounded-xl bg-gray-800 dark:bg-gray-700 text-white font-semibold shadow-lg hover:scale-105 transition-transform flex items-center justify-center gap-2">
                            <i class="fas fa-user-plus"></i> <span class="text-sm">${T.addContact}</span>
                        </button>
                        <a href="https://drive.google.com/file/d/1Uy0nAw024lmktAaQWHOS0MX5uP-RO_4q/view?usp=sharing" target="_blank" class="py-3 px-4 rounded-xl bg-purple-600 text-white font-semibold shadow-lg hover:bg-purple-700 hover:scale-105 transition-all flex items-center justify-center gap-2">
                            <i class="fas fa-download"></i> <span class="text-sm">${T.companyProfile}</span>
                        </a>
                    </div>

                    <!-- Bouton Projets (Lavande) -->
                    <button onclick="window.showPage('projects')" class="w-full mb-8 py-4 rounded-xl bg-gradient-to-r from-purple-500 to-indigo-600 text-white font-bold shadow-lg hover:shadow-purple-500/50 hover:scale-[1.02] transition-all flex items-center justify-center gap-3">
                        <i class="fas fa-briefcase"></i> ${T.lastProjects}
                    </button>
                    
                    <!-- Liste Contact -->
                    <div class="space-y-3">
                        <!-- Téléphone -->
                        <a href="tel:+966556988973" class="flex items-center p-3 rounded-xl transition-all hover:translate-x-1" style="background-color: var(--bg-links);">
                            <div class="w-10 h-10 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center mr-3 rtl:mr-0 rtl:ml-3">
                                <i class="fas fa-phone"></i>
                            </div>
                            <div class="flex-1">
                                <p class="text-xs opacity-70" style="color: var(--text-secondary);">${T.callMe}</p>
                                <p class="font-semibold text-sm" style="color: var(--text-primary);">+966 55 698 8973</p>
                            </div>
                        </a>

                        <!-- Email Michael -->
                        <a href="mailto:michael@rattanpalace.com" class="flex items-center p-3 rounded-xl transition-all hover:translate-x-1" style="background-color: var(--bg-links);">
                            <div class="w-10 h-10 rounded-full bg-purple-100 text-purple-600 flex items-center justify-center mr-3 rtl:mr-0 rtl:ml-3">
                                <i class="fas fa-envelope"></i>
                            </div>
                            <div class="flex-1">
                                <p class="text-xs opacity-70" style="color: var(--text-secondary);">${T.emailLabel}</p>
                                <p class="font-semibold text-sm break-all" style="color: var(--text-primary);">michael@rattanpalace.com</p>
                            </div>
                        </a>

                        <!-- Email Info -->
                        <a href="mailto:info@rattanpalace.com" class="flex items-center p-3 rounded-xl transition-all hover:translate-x-1" style="background-color: var(--bg-links);">
                            <div class="w-10 h-10 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center mr-3 rtl:mr-0 rtl:ml-3">
                                <i class="fas fa-info-circle"></i>
                            </div>
                            <div class="flex-1">
                                <p class="text-xs opacity-70" style="color: var(--text-secondary);">${T.infoLabel}</p>
                                <p class="font-semibold text-sm break-all" style="color: var(--text-primary);">info@rattanpalace.com</p>
                            </div>
                        </a>

                        <!-- WhatsApp -->
                        <a href="https://wa.me/966556988973" target="_blank" class="flex items-center p-3 rounded-xl transition-all hover:translate-x-1" style="background-color: var(--bg-links);">
                            <div class="w-10 h-10 rounded-full bg-green-100 text-green-600 flex items-center justify-center mr-3 rtl:mr-0 rtl:ml-3">
                                <i class="fab fa-whatsapp text-lg"></i>
                            </div>
                            <span class="font-semibold" style="color: var(--text-primary);">${T.whatsapp}</span>
                        </a>

                        <!-- Instagram -->
                        <a href="https://www.instagram.com/rattanpalace.sa/" target="_blank" class="flex items-center p-3 rounded-xl transition-all hover:translate-x-1" style="background-color: var(--bg-links);">
                            <div class="w-10 h-10 rounded-full bg-pink-100 text-pink-600 flex items-center justify-center mr-3 rtl:mr-0 rtl:ml-3">
                                <i class="fab fa-instagram text-lg"></i>
                            </div>
                            <span class="font-semibold" style="color: var(--text-primary);">${T.instagram}</span>
                        </a>

                        <!-- Location (Google Maps) -->
                        <a href="https://www.google.com/maps/search/?api=1&query=Rattan+Palace" target="_blank" class="flex items-center p-3 rounded-xl transition-all hover:translate-x-1" style="background-color: var(--bg-links);">
                            <div class="w-10 h-10 rounded-full bg-red-100 text-red-600 flex items-center justify-center mr-3 rtl:mr-0 rtl:ml-3">
                                <i class="fas fa-map-marker-alt"></i>
                            </div>
                            <span class="font-semibold" style="color: var(--text-primary);">${T.locationLabel}</span>
                        </a>
                    </div>

                    <!-- Google Review (Footer) -->
                    <div class="mt-8 text-center">
                        <a href="https://search.google.com/local/writereview?placeid=Placeholder" target="_blank" class="inline-flex items-center gap-2 text-sm opacity-70 hover:opacity-100 transition-opacity" style="color: var(--text-secondary);">
                            <div class="w-8 h-8 bg-white rounded-full flex items-center justify-center shadow-sm">
                                <img src="https://upload.wikimedia.org/wikipedia/commons/5/53/Google_%22G%22_Logo.svg" alt="Google" class="w-5 h-5">
                            </div>
                            <span>${T.reviewLabel}</span>
                        </a>
                    </div>
                `;
            } else if (state.currentPage === 'projects') {
                pageHTML = `
                    ${backButtonHTML}
                    <h2 class="text-2xl text-center font-bold mb-6" style="color: var(--text-primary);">${T.projectsTitle}</h2>
                    
                    <div class="space-y-4 max-h-[65vh] overflow-y-auto pr-1 scrollbar-hide">
                        ${window.appData.data.projects.map(p => `
                            <a href="https://www.instagram.com/rattanpalace.sa/" target="_blank" class="block p-5 rounded-xl transition-all duration-300 hover:scale-[1.02] border border-white/5" style="background-color: var(--bg-links);">
                                <div class="flex justify-between items-start gap-4">
                                    <div>
                                        <h3 class="font-bold text-lg leading-tight" style="color: var(--text-primary);">${p.name[lang]}</h3>
                                        <p class="text-sm mt-2 opacity-80" style="color: var(--text-links);">${p.description[lang]}</p>
                                    </div>
                                    <i class="fab fa-instagram text-pink-500 text-2xl mt-1"></i>
                                </div>
                            </a>
                        `).join('')}
                    </div>
                `;
            }

            content.innerHTML = pageHTML;
        }

        // --- 4. ANIMATION (Particules Dorées pour Mode Sombre) ---
        let particlesArray;
        
        function initParticles() {
            const canvas = document.getElementById('card-background-canvas');
            if(!canvas) return;
            const ctx = canvas.getContext('2d');
            const container = document.getElementById('card-container');
            
            canvas.width = container.offsetWidth;
            canvas.height = container.offsetHeight;

            // Couleur des particules : OR si sombre, GRIS si clair (mais l'utilisateur veut Or tout le temps ou défaut ?)
            // "keep the background with gold" -> On force l'or en mode sombre
            const isDark = window.appData.state.isDarkTheme;
            const pColor = isDark ? 'rgba(212, 175, 55, 0.4)' : 'rgba(100, 100, 100, 0.15)'; 
            
            particlesArray = [];
            let num = (canvas.width * canvas.height) / 8000;
            
            for(let i=0; i<num; i++){
                let size = (Math.random()*2)+0.5;
                let x = Math.random() * canvas.width;
                let y = Math.random() * canvas.height;
                let dX = (Math.random()*0.4)-0.2;
                let dY = (Math.random()*0.4)-0.2;
                particlesArray.push({x, y, dX, dY, size, color: pColor});
            }
        }

        function animateParticles() {
            const canvas = document.getElementById('card-background-canvas');
            if(!canvas) return;
            const ctx = canvas.getContext('2d');
            
            ctx.clearRect(0,0,canvas.width,canvas.height);
            
            const isDark = window.appData.state.isDarkTheme;
            // Couleur des lignes : Or si sombre
            const lColor = isDark ? '212, 175, 55' : '100, 100, 100';

            particlesArray.forEach(p => {
                p.x += p.dX;
                p.y += p.dY;
                
                if(p.x > canvas.width || p.x < 0) p.dX = -p.dX;
                if(p.y > canvas.height || p.y < 0) p.dY = -p.dY;
                
                ctx.beginPath();
                ctx.arc(p.x, p.y, p.size, 0, Math.PI*2);
                ctx.fillStyle = p.color;
                ctx.fill();
            });
            
            // Connexions
            for(let a=0; a<particlesArray.length; a++){
                for(let b=a; b<particlesArray.length; b++){
                    let dist = ((particlesArray[a].x-particlesArray[b].x)**2)+((particlesArray[a].y-particlesArray[b].y)**2);
                    if(dist < (canvas.width/6)*(canvas.height/6)){
                        let opacity = 1-(dist/15000);
                        ctx.strokeStyle = `rgba(${lColor}, ${opacity*0.4})`;
                        ctx.lineWidth=1;
                        ctx.beginPath();
                        ctx.moveTo(particlesArray[a].x, particlesArray[a].y);
                        ctx.lineTo(particlesArray[b].x, particlesArray[b].y);
                        ctx.stroke();
                    }
                }
            }
            
            window.animationFrameId = requestAnimationFrame(animateParticles);
        }

        // --- INITIALISATION ---
        document.addEventListener('DOMContentLoaded', () => {
            initParticles();
            animateParticles();
            renderApp(); // Premier rendu
            
            // Gestion du redimensionnement
            window.addEventListener('resize', () => { 
                initParticles(); 
            });
        });

    </script>
</body>
</html>
